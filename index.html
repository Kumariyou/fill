<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Flash Fill – Keywords Fixed</title>

<style>
body {
  font-family: Arial;
  background:#bbb7b7;
  padding: 20px;
}

.container {
  display: flex;
  gap: 25px;
  margin-bottom: 15px;
}

.box:first-child { flex: 3; }
.box:last-child { flex: 1; }

.box {
  background: #fff;
  padding: 12px;
  border-radius: 8px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.1);
}

textarea {
  width: 100%;
  height: 220px;
   background:#bbb7b7;
  padding: 10px;
  font-size: 14px;
}

button {
  padding: 10px 14px;
  margin: 6px 6px 6px 0;
  cursor: pointer;
}

table {
  width: 100%;
  margin-top: 15px;
  border-collapse: collapse;
  background:#bbb7b7;
}

td {
  border: 1px solid #000000;
  padding: 6px;
}
</style>

<link rel="stylesheet" href="style.css">

</head>

<body>

<h2>⚡ Flash Fill</h2>

<div class="container">
  <div class="box">
    <b>Input Data</b>
    <textarea id="input" placeholder="Paste data here"></textarea>
  </div>

  <div class="box">
    <b>Keywords (one per line)</b>
    <textarea id="keywords" placeholder="India&#10;USA&#10;Delhi"></textarea>
  </div>
</div>

<button class="button glow-button" target="_blank" onclick="flashFill()">Flash Fill</button>
<button class="button glow-button" target="_blank" onclick="copyResult()">Copy Output</button>

<div id="output"></div>

<script>

document.addEventListener('contextmenu', event => event.preventDefault());

let tableData = []

// Split ONLY numbers, keep all symbols
function splitNumbersOnlySafe(text) {
  return text.match(/\d+(?:\.\d+)?|[^\d]+/g) || []
}

function flashFill() {
  const input = document.getElementById("input").value.trim()
  const keyText = document.getElementById("keywords").value.trim()
  if (!input) return

  const keywords = keyText
    ? keyText.split("\n").map(k => k.trim()).filter(Boolean)
    : []

  tableData = []
  let html = "<table>"

  input.split("\n").forEach(originalLine => {
    let line = originalLine
    let foundKeywords = []

    // ✅ Extract keywords FIRST
    keywords.forEach(k => {
      if (line.includes(k)) {
        foundKeywords.push(k)
        line = line.replace(k, "")   // remove only keyword text
      }
    })

    // Split remaining text
    let cols = splitNumbersOnlySafe(line)

    // Clean empty cells
    cols = cols.map(c => c.trim()).filter(c => c !== "")

    // Append keywords as separate columns
    cols = [...cols, ...foundKeywords]

    tableData.push(cols)

    html += "<tr>"
    cols.forEach(c => html += `<td>${c}</td>`)
    html += "</tr>"
  })

  html += "</table>"
  document.getElementById("output").innerHTML = html
}

function copyResult() {
  let txt = ""
  tableData.forEach(r => txt += r.join("\t") + "\n")
  navigator.clipboard.writeText(txt)
  alert("Copied! Paste into Excel / Sheets.")
}
</script>

</body>
</html>
